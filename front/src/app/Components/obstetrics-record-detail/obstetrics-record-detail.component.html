<div class="sub-record-detail-container">
  <!-- Left Side: Obstetrics Record and Consultation Details -->
  <div class="sub-record-main-content">
    <div *ngIf="obstetricsRecord; else loading">
      <!-- Obstetrics Record Details (always shown) -->
      <div class="sub-record-section">
        <h2 class="sub-record-section-header">
          <svg xmlns="http://www.w3.org/2000/svg" class="sub-record-section-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd" />
          </svg>
          Obstetrics Record Details
        </h2>
        <div class="sub-record-detail-grid">
          <div class="sub-record-detail-item">
            <span class="sub-record-detail-label">ID</span>
            <span class="sub-record-detail-value">{{ obstetricsRecord.id }}</span>
          </div>
          <div class="sub-record-detail-item">
            <span class="sub-record-detail-label">Conception Type</span>
            <span class="sub-record-detail-value">{{ obstetricsRecord.conceptionType }}</span>
          </div>
          <div class="sub-record-detail-item">
            <span class="sub-record-detail-label">Conception Date</span>
            <span class="sub-record-detail-value" [class.obstetrics-detail-value-empty]="!obstetricsRecord.conceptionDate">
              {{ obstetricsRecord.conceptionDate ? (obstetricsRecord.conceptionDate | date:'yyyy-MM-dd') : 'None' }}
            </span>
          </div>
          <div class="sub-record-detail-item">
            <span class="sub-record-detail-label">Last Menstrual Period</span>
            <span class="sub-record-detail-value" [class.obstetrics-detail-value-empty]="!obstetricsRecord.ddr">
              {{ obstetricsRecord.ddr ? (obstetricsRecord.ddr | date:'yyyy-MM-dd') : 'None' }}
            </span>
          </div>
          <div class="sub-record-detail-item">
            <span class="sub-record-detail-label">Record Date</span>
            <span class="sub-record-detail-value" [class.obstetrics-detail-value-empty]="!obstetricsRecord.date">
              {{ obstetricsRecord.date ? (obstetricsRecord.date | date:'yyyy-MM-dd') : 'None' }}
            </span>
          </div>
          <div class="sub-record-detail-item">
            <span class="sub-record-detail-label">Number of Fetuses</span>
            <span class="sub-record-detail-value">{{ obstetricsRecord.nfoetus }}</span>
          </div>
          <div class="sub-record-detail-item">
            <span class="sub-record-detail-label">Comment</span>
            <span class="sub-record-detail-value" [class.obstetrics-detail-value-empty]="!obstetricsRecord.comment">
              {{ obstetricsRecord.comment || 'None' }}
            </span>
          </div>
          <div class="sub-record-detail-item">
            <span class="sub-record-detail-label">Medical Record ID</span>
            <span class="sub-record-detail-value">{{ obstetricsRecord.medicalRecordId }}</span>
          </div>
        </div>
      </div>

      <!-- Consultation Details (shown when a consultation is selected) -->
      <div *ngIf="selectedConsultationId()" class="sub-record-section">
        <h2 class="sub-record-section-header">
          <svg xmlns="http://www.w3.org/2000/svg" class="sub-record-section-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd" />
          </svg>
          Consultation Details
        </h2>
        <div class="consultation-detail-container">
          <div class="consultation-detail-content">
            <app-consultation-detail [consultationId]="selectedConsultationId()!"></app-consultation-detail>
          </div>
        </div>
      </div>

      <!-- Consultation Edit Form -->
      <div *ngIf="selectedEditConsultationId()" class="sub-record-section">
        <h2 class="sub-record-section-header">
          <svg xmlns="http://www.w3.org/2000/svg" class="sub-record-section-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" clip-rule="evenodd" />
          </svg>
          Edit Consultation
        </h2>
        <div class="consultation-detail-container">
          <div class="consultation-detail-content">
            <app-consultation-form
              [consultationId]="selectedEditConsultationId()!"
              (formSubmitted)="setSelectedEditConsultationId(null)"
            />
          </div>
        </div>
      </div>
    </div>
    
    <ng-template #loading>
      <div class="loading-container">
        <p class="loading-text">Loading obstetrics record...</p>
      </div>
    </ng-template>
  </div>

  <!-- Right Side: Consultation List -->
  <div class="sub-record-sidebar">
    <div *ngIf="obstetricsRecord; else loadingSidebar">
      <div class="sub-record-section">
        <h2 class="sub-record-section-header">
          <svg xmlns="http://www.w3.org/2000/svg" class="sub-record-section-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd" />
          </svg>
          Consultations
        </h2>
        <app-consultation-list 
          [consultations]="obstetricsRecord.consultations" 
          [setSelectedConsultationId]="setSelectedConsultationId.bind(this)" 
          [setSelectedEditConsultationId]="setSelectedEditConsultationId.bind(this)">
        </app-consultation-list>
      </div>
    </div>
    
    <ng-template #loadingSidebar>
      <div class="loading-container">
        <p class="loading-text">Loading consultations...</p>
      </div>
    </ng-template>
    
    <div *ngIf="error" class="error-container">
      <p class="error-text">{{ error }}</p>
    </div>
  </div>
</div>